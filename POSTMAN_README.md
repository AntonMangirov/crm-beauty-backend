# Postman Collection для тестирования API

## Установка

1. Откройте Postman
2. Импортируйте файл `postman_collection.json`
3. Установите переменные окружения:
   - `baseUrl`: `http://localhost:3000` (или ваш URL)
   - `masterSlug`: `anna-krasotkina` (или другой slug мастера)
   - `serviceId`: ID услуги мастера (получите из GET `/api/public/:slug`)
   - `recaptchaToken`: тестовый токен (в dev режиме может быть любым)

## Получение serviceId

1. Выполните запрос `Get Master Profile`
2. В ответе найдите массив `services[]`
3. Скопируйте `id` нужной услуги
4. Установите в переменную `serviceId`

## Тестовые сценарии

### 1. Valid Booking
Валидная запись к мастеру. Ожидается статус 201.

### 2. Invalid Service ID
Тест с неверным `serviceId`. Ожидается:
- Статус: 400
- Сообщение: "Услуга не найдена, неактивна или не принадлежит данному мастеру"
- Лог в `logs/error.log` и `logs/booking.log`

### 3. Time Slot Conflict
Попытка записаться на уже занятое время. Ожидается:
- Статус: 409
- Сообщение: "Выбранное время уже занято"
- Лог конфликта в `logs/error.log`

### 4. Invalid Date Format
Неверный формат даты. Ожидается:
- Статус: 400
- Ошибка валидации Zod
- Лог в `logs/error.log`

### 5. Invalid Phone Format
Неверный формат телефона. Ожидается:
- Статус: 400
- Сообщение: "Неверный формат телефона"
- Лог в `logs/error.log`

### 6. Past Date
Попытка записаться в прошлое. Ожидается:
- Статус: 400
- Ошибка валидации (дата в прошлом)
- Лог в `logs/error.log`

### 7. Weekend Date
Попытка записаться на выходной (суббота/воскресенье). Ожидается:
- Статус: 400
- Ошибка валидации (выходной день)
- Лог в `logs/error.log`

### 8. Outside Working Hours
Попытка записаться вне рабочих часов (после 18:00 UTC). Ожидается:
- Статус: 400
- Ошибка валидации (вне рабочих часов)
- Лог в `logs/error.log`

### 9. Missing reCAPTCHA Token
Запрос без `recaptchaToken`. Ожидается:
- Статус: 400
- Ошибка валидации (отсутствует токен)
- Лог в `logs/error.log`

## Логи

Все ошибки логируются в:
- `logs/error.log` - все ошибки
- `logs/booking.log` - логи бронирования
- `logs/app.log` - общие логи приложения

## Примечания

- В режиме разработки (`NODE_ENV=development`) reCAPTCHA проверка может быть пропущена если ключ не установлен
- Все даты должны быть в формате ISO 8601 (UTC): `2025-11-06T13:00:00.000Z`
- Телефоны должны быть в российском формате: `+79991234567`, `89991234567`, `+7 (999) 123-45-67`



