# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –≤—ã —É–∂–µ:

- ‚úÖ –°–∫–∞—á–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç —Å Git (`git clone` –∏–ª–∏ `git pull`)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`npm install` –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`)
- ‚úÖ –ò–º–µ–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Docker

## ‚ö†Ô∏è –í–∞–∂–Ω–æ! –ü—Ä–æ–±–ª–µ–º–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

–ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Docker —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è, —Å–ª–µ–¥—É–π—Ç–µ —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `npm run db:migrate` (–∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç `prisma migrate dev`) Prisma –º–æ–∂–µ—Ç:

- –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é, –µ—Å–ª–∏ —Å—Ö–µ–º–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- –ü—Ä–∏–º–µ–Ω—è—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –ø—É—Å—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—ã–ª –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω
- –¢–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑-–∑–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

---

## ‚úÖ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞, Docker –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ)

```bash
docker ps -a | grep crm-postgres
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**–í–∞—Ä–∏–∞–Ω—Ç A: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∑–∞–ø—É—â–µ–Ω**

```
CONTAINER ID   IMAGE         COMMAND                  CREATED         STATUS         PORTS                    NAMES
abc123def456   postgres:15   "docker-entrypoint.s‚Ä¶"  2 hours ago     Up 2 hours     0.0.0.0:5433->5432/tcp   crm-postgres
```

‚úÖ **–î–µ–π—Å—Ç–≤–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 3

**–í–∞—Ä–∏–∞–Ω—Ç B: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**

```
CONTAINER ID   IMAGE         COMMAND                  CREATED         STATUS                    PORTS     NAMES
abc123def456   postgres:15   "docker-entrypoint.s‚Ä¶"  2 hours ago     Exited (0) 2 hours ago             crm-postgres
```

‚úÖ **–î–µ–π—Å—Ç–≤–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 3

```bash
docker start crm-postgres
```

**–í–∞—Ä–∏–∞–Ω—Ç C: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω (–ø—É—Å—Ç–æ–π –≤—ã–≤–æ–¥)**

```
(–ø—É—Å—Ç–æ)
```

‚úÖ **–î–µ–π—Å—Ç–≤–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 2

---

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å volume (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞)

**–ï—Å–ª–∏ —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ:**

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
docker stop crm-postgres
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

- `crm-postgres` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚úÖ
- `Error: No such container: crm-postgres` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚úÖ

```bash
# –£–¥–∞–ª–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker rm crm-postgres
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

- `crm-postgres` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–¥–∞–ª–µ–Ω ‚úÖ
- `Error: No such container: crm-postgres` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚úÖ

**–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å volume:**

```bash
docker run --name crm-postgres \
  -e POSTGRES_PASSWORD=12345 \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_DB=crm_beauty_db \
  -p 5433:5432 \
  -v crm-postgres-data:/var/lib/postgresql/data \
  -d postgres:15
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**–£—Å–ø–µ—Ö:**

```
abc123def4567890abcdef1234567890abcdef1234567890abcdef1234567890ab
```

(–≠—Ç–æ ID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ - –∑–Ω–∞—á–∏—Ç –≤—Å—ë —Ö–æ—Ä–æ—à–æ) ‚úÖ

**–û—à–∏–±–∫–∞: "Conflict. The container name "/crm-postgres" is already in use"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ:

```bash
docker rm -f crm-postgres
# –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É docker run
```

**–û—à–∏–±–∫–∞: "port is already allocated"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:** –ü–æ—Ä—Ç 5433 –∑–∞–Ω—è—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–ø—É—â–µ–Ω–æ:

```bash
docker ps | grep 5433
# –ï—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ –∫–æ–º–∞–Ω–¥–µ –Ω–∞ -p 5434:5432
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω:**

```bash
docker ps | grep crm-postgres
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```
CONTAINER ID   IMAGE         COMMAND                  CREATED         STATUS         PORTS                    NAMES
abc123def456   postgres:15   "docker-entrypoint.s‚Ä¶"  5 seconds ago    Up 4 seconds   0.0.0.0:5433->5432/tcp   crm-postgres
```

‚úÖ **–í–∞–∂–Ω–æ:** –§–ª–∞–≥ `-v crm-postgres-data:/var/lib/postgresql/data` —Å–æ–∑–¥–∞–µ—Ç volume, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –±—ç–∫–µ–Ω–¥–∞

```bash
cd crm-beauty-backend
```

**–°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env`:**

**Windows (PowerShell):**

```powershell
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª
Test-Path .env

# –ï—Å–ª–∏ False, —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª
New-Item .env -ItemType File
```

**Windows (CMD) –∏–ª–∏ Linux/Mac:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª
ls .env

# –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ
touch .env
```

**–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ/–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:**

```env
DATABASE_URL="postgresql://postgres:12345@localhost:5433/crm_beauty_db"
JWT_SECRET="your-jwt-secret-key-change-in-production"
PORT=3000
NODE_ENV=development
```

**–í–∞–∂–Ω–æ:**

- –ü–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `5433` (–Ω–µ `5432`!)
- –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `12345` (–∫–∞–∫ –≤ Docker –∫–æ–º–∞–Ω–¥–µ)
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `crm_beauty_db`

---

### –®–∞–≥ 4: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ!)

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prisma migrate deploy`, –∞ –ù–ï `prisma migrate dev`!

**–í–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```bash
npm run db:setup
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**–£—Å–ø–µ—Ö:**

```
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "crm_beauty_db", schema "public" at "localhost:5433"

‚úî Generated Prisma Client (v6.16.2) to .\node_modules\@prisma\client in 123ms

Running migration(s)...
Applying migration `20250928031718_init`
Applying migration `20250101000000_add_master_contacts_rating_and_service_photo`
...
‚úî Applied all migrations successfully.
```

‚úÖ **–î–µ–π—Å—Ç–≤–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 5

**–û—à–∏–±–∫–∞: "Can't reach database server"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker ps | grep crm-postgres`
2. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `docker start crm-postgres`
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 —Å–µ–∫—É–Ω–¥ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É

**–û—à–∏–±–∫–∞: "P1001: Can't reach database server"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ `.env` - –ø–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `5433`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker logs crm-postgres`
3. –ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –æ—à–∏–±–∫–∏, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–®–∞–≥ 2)

**–û—à–∏–±–∫–∞: "P1003: Database does not exist"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–Ω–∞. –°–æ–∑–¥–∞–π—Ç–µ –µ—ë –≤ Docker:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
docker exec -it crm-postgres psql -U postgres

# –í psql –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
CREATE DATABASE crm_beauty_db;
\q

# –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ npm run db:setup
```

**–û—à–∏–±–∫–∞: "Migration failed to apply"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:** –°–º. —Ä–∞–∑–¥–µ–ª "–†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π" –Ω–∏–∂–µ

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ—à–∞–≥–æ–≤–æ**

```bash
# 1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Prisma Client
npx prisma generate
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```
‚úî Generated Prisma Client (v6.16.2) to .\node_modules\@prisma\client in 123ms
```

```bash
# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–ù–ï —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ!)
npx prisma migrate deploy
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```
Running migration(s)...
Applying migration `20250928031718_init`
Applying migration `20250101000000_add_master_contacts_rating_and_service_photo`
...
‚úî Applied all migrations successfully.
```

```bash
# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
npx prisma migrate status
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```
Database schema is up to date!

Following migration(s) have been applied:
  migration_name_1
  migration_name_2
  ...
```

**–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏:**

- `prisma migrate dev` - —Å–æ–∑–¥–∞–µ—Ç –ù–û–í–£–Æ –º–∏–≥—Ä–∞—Ü–∏—é –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –µ—ë (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ö–µ–º—ã!)
- `prisma migrate deploy` - –ø—Ä–∏–º–µ–Ω—è–µ—Ç –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ –ø–∞–ø–∫–∏ `prisma/migrations/` (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î!)

---

### –®–∞–≥ 5: –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –±–∞–∑—É —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

```bash
npm run seed
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**–£—Å–ø–µ—Ö:**

```
üå± –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...

üë©‚ÄçüíÖ –°–æ–∑–¥–∞–µ–º –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É...
‚úÖ –ú–∞—Å—Ç–µ—Ä –ê–Ω–Ω–∞ —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω
‚úÖ –£—Å–ª—É–≥–∏ –¥–ª—è –ê–Ω–Ω—ã —Å–æ–∑–¥–∞–Ω—ã (4 —É—Å–ª—É–≥–∏)

üë©‚Äçüíº –°–æ–∑–¥–∞–µ–º –º–∞—Å—Ç–µ—Ä–∞ –ú–∞—Ä–∏—é...
‚úÖ –ú–∞—Å—Ç–µ—Ä –ú–∞—Ä–∏—è —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω
‚úÖ –£—Å–ª—É–≥–∏ –¥–ª—è –ú–∞—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã (5 —É—Å–ª—É–≥)

‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞!
```

‚úÖ **–î–µ–π—Å—Ç–≤–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 6

**–û—à–∏–±–∫–∞: "Can't reach database server"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:** –°–º. —Ä–µ—à–µ–Ω–∏–µ –≤ –®–∞–≥–µ 4

**–û—à–∏–±–∫–∞: "Table does not exist"**
‚ùå **–†–µ—à–µ–Ω–∏–µ:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ –®–∞–≥—É 4 –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `npm run db:setup`

---

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Prisma Studio (–≤–∏–∑—É–∞–ª—å–Ω–æ)**

```bash
npm run db:studio
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä —Å –∞–¥—Ä–µ—Å–æ–º `http://localhost:5555`. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã `User` –∏ `Service` - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–∞–Ω–Ω—ã–µ.

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ API (–µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω)**

**–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):**

```bash
cd crm-beauty-backend
npm run dev
```

**–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:3000/api/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
{ "status": "ok", "database": "connected" }
```

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–∞—Å—Ç–µ—Ä–æ–≤ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–∞–Ω–Ω—ã–µ!)
curl http://localhost:3000/api/masters
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
[
  {
    "id": "...",
    "name": "–ê–Ω–Ω–∞ –ö—Ä–∞—Å–æ—Ç–∫–∏–Ω–∞",
    "slug": "anna-krasotkina",
    ...
  },
  {
    "id": "...",
    "name": "–ú–∞—Ä–∏—è –°—Ç–∏–ª—å–Ω–∞—è",
    "slug": "maria-stilnaya",
    ...
  }
]
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Docker (–ø—Ä—è–º–æ–π SQL –∑–∞–ø—Ä–æ—Å)**

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞)

```bash
docker exec -it crm-postgres psql -U postgres -d crm_beauty_db -c "SELECT name, email FROM \"User\";"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```
        name         |      email
---------------------+------------------
 –ê–Ω–Ω–∞ –ö—Ä–∞—Å–æ—Ç–∫–∏–Ω–∞     | anna@example.com
 –ú–∞—Ä–∏—è –°—Ç–∏–ª—å–Ω–∞—è      | maria@example.com
(2 rows)
```

---

## üîß –†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–µ—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

–ï—Å–ª–∏ `prisma migrate deploy` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é.

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

**–®–∞–≥ 1: –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π**

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π
ls prisma/migrations
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**

```
20250928031718_init
20250101000000_add_master_contacts_rating_and_service_photo
20250120120000_add_telegram_username_to_client
...
```

**–®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Docker**

–î–ª—è –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ <–∏–º—è_–º–∏–≥—Ä–∞—Ü–∏–∏> –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –∏–º—è –ø–∞–ø–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
docker exec -i crm-postgres psql -U postgres -d crm_beauty_db < prisma/migrations/<–∏–º—è_–º–∏–≥—Ä–∞—Ü–∏–∏>/migration.sql
```

**–ü—Ä–∏–º–µ—Ä:**

```bash
docker exec -i crm-postgres psql -U postgres -d crm_beauty_db < prisma/migrations/20250928031718_init/migration.sql
docker exec -i crm-postgres psql -U postgres -d crm_beauty_db < prisma/migrations/20250101000000_add_master_contacts_rating_and_service_photo/migration.sql
# –ò —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–ª—è –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π –ø–æ –ø–æ—Ä—è–¥–∫—É
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**–£—Å–ø–µ—Ö:**

```
(–ø—É—Å—Ç–æ–π –≤—ã–≤–æ–¥ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü)
```

**–û—à–∏–±–∫–∞: "relation already exists"**
‚úÖ –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –º–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ —Å–ª–µ–¥—É—é—â–µ–π.

**–û—à–∏–±–∫–∞: "syntax error"**
‚ùå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏. –í–æ–∑–º–æ–∂–Ω–æ, –æ–Ω –ø–æ–≤—Ä–µ–∂–¥–µ–Ω.

**–®–∞–≥ 3: –ü–æ–º–µ—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ**

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è SQL –≤—Ä—É—á–Ω—É—é –Ω—É–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ Prisma:

```bash
# –î–ª—è –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
npx prisma migrate resolve --applied <–∏–º—è_–º–∏–≥—Ä–∞—Ü–∏–∏>
```

**–ü—Ä–∏–º–µ—Ä:**

```bash
npx prisma migrate resolve --applied 20250928031718_init
npx prisma migrate resolve --applied 20250101000000_add_master_contacts_rating_and_service_photo
# –ò —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π
```

**–®–∞–≥ 4: –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Prisma Client**

```bash
npx prisma generate
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ psql –Ω–∞–ø—Ä—è–º—É—é

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞)

**–®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**

```bash
docker exec -it crm-postgres psql -U postgres -d crm_beauty_db
```

**–®–∞–≥ 2: –í psql –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏**

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `prisma/migrations/20250928031718_init/migration.sql`) –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ psql.

**–ü—Ä–∏–º–µ—Ä:**

```sql
-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ migration.sql
CREATE TABLE "User" (
  ...
);
```

**–®–∞–≥ 3: –í—ã–π–¥–∏—Ç–µ –∏–∑ psql**

```sql
\q
```

**–®–∞–≥ 4: –ü–æ–º–µ—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é**

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

```bash
cd crm-beauty-backend
npx prisma migrate resolve --applied <–∏–º—è_–º–∏–≥—Ä–∞—Ü–∏–∏>
npx prisma generate
```

---

## üîÑ –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ë–î

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

**–®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ —É–¥–∞–ª–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**

```bash
docker stop crm-postgres
docker rm crm-postgres
```

**–®–∞–≥ 2: –£–¥–∞–ª–∏—Ç–µ volume —Å –¥–∞–Ω–Ω—ã–º–∏**

```bash
docker volume rm crm-postgres-data
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

- `crm-postgres-data` - volume —É–¥–∞–ª–µ–Ω ‚úÖ
- `Error: No such volume` - volume –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚úÖ

**–®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–Ω–æ–≤–æ**

–°–º. –®–∞–≥ 2 –≤—ã—à–µ.

**–®–∞–≥ 4: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏**

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

```bash
cd crm-beauty-backend
npm run db:setup
```

**–®–∞–≥ 5: –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–º–∏**

```bash
npm run seed
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ db:reset (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

```bash
cd crm-beauty-backend
npm run db:reset
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**–£—Å–ø–µ—Ö:**

```
Are you sure you want to reset the database? All data will be lost. (y/N)
```

–í–≤–µ–¥–∏—Ç–µ `y` –∏ –Ω–∞–∂–º–∏—Ç–µ Enter.

**–ü–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–º–∏:**

```bash
npm run seed
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** `db:reset` —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã!

---

## üÜò –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞: "Migration failed to apply"

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
npx prisma migrate status
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**

**"X migration(s) have been applied"**
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ.

**"X migration(s) are pending"**
‚ùå –ï—Å—Ç—å –Ω–µ–ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:

```bash
npx prisma migrate deploy
```

**"Migration failed"**
‚ùå –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é (—Å–º. —Ä–∞–∑–¥–µ–ª "–†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π" –≤—ã—à–µ)

### –û—à–∏–±–∫–∞: "Container already exists"

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞)

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker start crm-postgres

# –í–∞—Ä–∏–∞–Ω—Ç 2: –£–¥–∞–ª–∏—Ç–µ –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ
docker rm -f crm-postgres
# –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π (—Å–º. –®–∞–≥ 2)
```

### –û—à–∏–±–∫–∞: "Cannot connect to database"

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

**–†–µ—à–µ–Ω–∏–µ:**

**1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω:**

```bash
docker ps | grep crm-postgres
```

**–ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω:**

```bash
docker start crm-postgres
# –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 —Å–µ–∫—É–Ω–¥
```

**2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

```bash
docker logs crm-postgres
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö:**

- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—Å–º. –®–∞–≥ 2)

**3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ `.env`:**

- –ü–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `5433` (–Ω–µ `5432`!)
- –•–æ—Å—Ç: `localhost`
- –ü–∞—Ä–æ–ª—å: `12345`
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `crm_beauty_db`

**4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é:**

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞)

```bash
docker exec -it crm-postgres psql -U postgres -d crm_beauty_db -c "SELECT 1;"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```
 ?column?
----------
        1
(1 row)
```

–ï—Å–ª–∏ —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–±–ª–µ–º–∞ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

### –û—à–∏–±–∫–∞: "P1001: Can't reach database server"

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

**–†–µ—à–µ–Ω–∏–µ:**

**1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:**

```bash
docker ps | grep crm-postgres
```

**2. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω:**

```bash
docker start crm-postgres
```

**3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 5433 –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
netstat -an | grep 5433
# Windows PowerShell:
Get-NetTCPConnection -LocalPort 5433
```

**4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ `.env`**

### –û—à–∏–±–∫–∞: "P1003: Database does not exist"

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

**–†–µ—à–µ–Ω–∏–µ:**

**1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL:**

```bash
docker exec -it crm-postgres psql -U postgres
```

**2. –í psql –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö:**

```sql
\l
```

**3. –ï—Å–ª–∏ –±–∞–∑—ã `crm_beauty_db` –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –µ—ë:**

```sql
CREATE DATABASE crm_beauty_db;
```

**4. –í—ã–π–¥–∏—Ç–µ –∏–∑ psql:**

```sql
\q
```

**5. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:**

```bash
cd crm-beauty-backend
npm run db:setup
```

### –û—à–∏–±–∫–∞: "Shadow database creation failed"

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `prisma migrate dev`.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prisma migrate deploy` –≤–º–µ—Å—Ç–æ `prisma migrate dev`:

```bash
npx prisma migrate deploy
```

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é (—Å–º. —Ä–∞–∑–¥–µ–ª "–†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π" –≤—ã—à–µ).

---

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### –†–∞–±–æ—Ç–∞ —Å Docker

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–ª—é–±–∞—è –ø–∞–ø–∫–∞)

```bash
# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–µ—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
docker start crm-postgres

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker stop crm-postgres

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker logs crm-postgres

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
docker logs --tail 50 crm-postgres

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —á–µ—Ä–µ–∑ psql
docker exec -it crm-postgres psql -U postgres -d crm_beauty_db

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –∫–æ–º–∞–Ω–¥—ã –Ω–∞–ø—Ä—è–º—É—é
docker exec -it crm-postgres psql -U postgres -d crm_beauty_db -c "SELECT COUNT(*) FROM \"User\";"
```

### –†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

```bash
cd crm-beauty-backend

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π (–ø–æ—Å–ª–µ git pull)
npm run db:setup
# –ò–ª–∏ –ø–æ—à–∞–≥–æ–≤–æ:
# npx prisma generate
# npx prisma migrate deploy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–π
npx prisma migrate status

# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm run seed

# –û—Ç–∫—Ä—ã—Ç—å Prisma Studio –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
npm run db:studio
```

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prisma migrate dev`?

**–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å:** –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≤ –ø–∞–ø–∫–µ `crm-beauty-backend`

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prisma migrate dev` –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞:

- –í—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Ñ–∞–π–ª `prisma/schema.prisma`
- –í–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ù–û–í–£–Æ –º–∏–≥—Ä–∞—Ü–∏—é
- –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –Ω–∞–¥ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é

**–ü—Ä–∏–º–µ—Ä:**

```bash
cd crm-beauty-backend

# 1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ prisma/schema.prisma (–¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ, —Ç–∞–±–ª–∏—Ü—É –∏ —Ç.–¥.)

# 2. –°–æ–∑–¥–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate dev --name add_new_field

# 3. Prisma —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç –µ—ë
```

**–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** `prisma migrate dev` –¥–ª—è:

- –ü–µ—Ä–≤–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –ø–æ—Å–ª–µ `git pull`
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–í —ç—Ç–∏—Ö —Å–ª—É—á–∞—è—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prisma migrate deploy` –∏–ª–∏ `npm run db:setup`!

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

- [ ] Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
- [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `crm-postgres` —Å–æ–∑–¥–∞–Ω —Å volume (`-v crm-postgres-data:/var/lib/postgresql/data`)
- [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω (`docker ps | grep crm-postgres` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
- [ ] –§–∞–π–ª `.env` —Å–æ–∑–¥–∞–Ω –≤ –ø–∞–ø–∫–µ `crm-beauty-backend` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `DATABASE_URL`
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `npm run db:setup` (–∏–ª–∏ `npx prisma generate` + `npx prisma migrate deploy`)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (`npx prisma migrate status` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Database schema is up to date!")
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `npm run seed`
- [ ] –î–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Prisma Studio –∏–ª–∏ —á–µ—Ä–µ–∑ API (`curl http://localhost:3000/api/masters`)

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ volume –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** - —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prisma migrate deploy` –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π** - —ç—Ç–æ –Ω–µ —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π** –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã: `npx prisma migrate status`
4. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª–æ–≥–∏ Docker** –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º: `docker logs crm-postgres > docker-logs.txt`
5. **–ù–µ —É–¥–∞–ª—è–π—Ç–µ volume –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏** - —Ç–∞–º —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ë–î

---

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏ Docker: `docker logs crm-postgres > docker-logs.txt`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π: `npx prisma migrate status > migration-status.txt`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `.env` —Ñ–∞–π–ª–∞ (–±–µ–∑ –ø–∞—Ä–æ–ª–µ–π!)
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å —ç—Ç–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
