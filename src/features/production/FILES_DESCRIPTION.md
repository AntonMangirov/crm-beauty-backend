# üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### `rateLimit.ts` ‚Üí `src/middleware/rateLimit.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π API

- **authRateLimit:** 5 –ø–æ–ø—ã—Ç–æ–∫ –ª–æ–≥–∏–Ω–∞ –∑–∞ 15 –º–∏–Ω—É—Ç
- **registerRateLimit:** 3 —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —á–∞—Å
- **passwordResetRateLimit:** 3 –ø–æ–ø—ã—Ç–∫–∏ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –≤ —á–∞—Å
- **apiRateLimit:** 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –∑–∞ 15 –º–∏–Ω—É—Ç

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π, –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω

---

### `emailController.ts` ‚Üí `src/controllers/emailController.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ —Å–±—Ä–æ—Å–æ–º –ø–∞—Ä–æ–ª—è

- **sendEmailVerification():** –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email
- **verifyEmail():** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –ø–æ —Ç–æ–∫–µ–Ω—É
- **requestPasswordReset():** –ó–∞–ø—Ä–æ—Å —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
- **resetPassword():** –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è –ø–æ —Ç–æ–∫–µ–Ω—É

**API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**

- `POST /api/auth/send-verification` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞
- `GET /api/auth/verify-email/:token` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email
- `POST /api/auth/forgot-password` - –∑–∞–ø—Ä–æ—Å —Å–±—Ä–æ—Å–∞
- `POST /api/auth/reset-password/:token` - —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å email —Å–µ—Ä–≤–∏—Å–æ–º

---

### `tokens.ts` ‚Üí `src/utils/tokens.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤

- **generateEmailVerifyToken():** –¢–æ–∫–µ–Ω –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email
- **generatePasswordResetToken():** –¢–æ–∫–µ–Ω –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
- **generateRefreshToken():** Refresh token –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **createPasswordResetToken():** –¢–æ–∫–µ–Ω —Å–±—Ä–æ—Å–∞ —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ 1 —á–∞—Å
- **createRefreshToken():** Refresh token —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π
- **createAccessToken():** Access token —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç
- **isTokenExpired():** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è, refresh tokens

---

### `argon2Password.ts` ‚Üí `src/utils/argon2Password.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

- **hashPassword():** –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è (Argon2 –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, bcrypt –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- **verifyPassword():** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
- **isBcryptHash():** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ö–µ—à–∞
- **migratePasswordHash():** –ú–∏–≥—Ä–∞—Ü–∏—è —Å bcrypt –Ω–∞ Argon2

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Argon2:**

- –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω OWASP
- –£—Å—Ç–æ–π—á–∏–≤ –∫ GPU –∞—Ç–∞–∫–∞–º

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Argon2:**

- memoryCost: 64 MB (2^16)
- timeCost: 3 –∏—Ç–µ—Ä–∞—Ü–∏–∏
- parallelism: 1 –ø–æ—Ç–æ–∫

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω, –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üîÑ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### `refreshTokens.ts` ‚Üí `src/controllers/refreshController.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ refresh tokens

- **refreshToken():** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token —Å –ø–æ–º–æ—â—å—é refresh token
- **revokeToken():** –û—Ç–∑—ã–≤ refresh token (–≤—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã)
- **issueRefreshToken():** –í—ã–¥–∞—á–∞ refresh token –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ

**API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**

- `POST /api/auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token
- `POST /api/auth/revoke` - –æ—Ç–∑—ã–≤ refresh token

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

- Access token: 15 –º–∏–Ω—É—Ç –∂–∏–∑–Ω–∏
- Refresh token: 7 –¥–Ω–µ–π –∂–∏–∑–Ω–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–µ access tokens

---

## üìß Email (–±—É–¥—É—â–∏–µ —Ñ–∞–π–ª—ã)

### `emailService.ts` ‚Üí `src/services/emailService.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ email (SendGrid, AWS SES, Nodemailer)

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö email –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –®–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º
- –û—á–µ—Ä–µ–¥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

### `emailTemplates.ts` ‚Üí `src/templates/emailTemplates.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –®–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email
- –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### `emailQueue.ts` ‚Üí `src/queues/emailQueue.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—á–µ—Ä–µ–¥—å –æ—Ç–ø—Ä–∞–≤–∫–∏ email

- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
- Retry –ª–æ–≥–∏–∫–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

## üéØ –ü–æ—Ä—è–¥–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π:

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **Rate Limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

### –≠—Ç–∞–ø 2: Email —Å–∏—Å—Ç–µ–º–∞

1. **Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email
2. **–°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è** - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
3. **Email —Å–µ—Ä–≤–∏—Å** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º

### –≠—Ç–∞–ø 3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

1. **Refresh tokens** - –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. **Argon2 –ø–∞—Ä–æ–ª–∏** - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **–ö–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–µ —Ç–æ–∫–µ–Ω—ã** - —É–ª—É—á—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –≠—Ç–∞–ø 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
2. **–ú–µ—Ç—Ä–∏–∫–∏** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. **–ê–ª–µ—Ä—Ç—ã** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ** - –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
2. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏** - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –ë–î
3. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–∏–ø—ã** - TypeScript –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –æ –Ω–æ–≤—ã—Ö –ø–æ–ª—è—Ö
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ API** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ** - –æ–±–Ω–æ–≤–ª—è–π—Ç–µ README —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏



